<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2024b"><title>Data export</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(192, 76, 11); font-family: Helvetica, Arial, sans-serif, Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: 700; text-align: left;  }
.S1 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif, Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S2 { border-left: 0px none rgb(33, 33, 33); border-right: 0px none rgb(33, 33, 33); border-top: 0px none rgb(33, 33, 33); border-bottom: 0px none rgb(33, 33, 33); border-radius: 0px; padding: 0px; line-height: 15.6px; min-height: 16px; white-space: pre; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 12px;  }
.S3 { margin: 10px 0px 20px; padding-left: 0px; font-family: Helvetica, Arial, sans-serif, Helvetica, Arial, sans-serif; font-size: 14px;  }
.S4 { margin-left: 56px; line-height: 21px; min-height: 0px; text-align: left; white-space: pre-wrap;  }
.S5 { margin-bottom: 20px; padding-bottom: 4px;  }
.S6 { margin: 0px; padding: 10px 0px 10px 5px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif, Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 700; text-align: start;  }
.S7 { margin: -1px 0px 0px; padding: 10px 0px 10px 7px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif, Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: start;  }
.S8 { margin: 20px 10px 5px 4px; padding: 0px; line-height: 25px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif, Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.CodeBlock { background-color: #F5F5F5; margin: 10px 15px 10px 0; display: inline-block }
.S9 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 1px solid rgb(217, 217, 217); border-bottom: 0px none rgb(33, 33, 33); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace, Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S10 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 0px none rgb(33, 33, 33); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace, Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S11 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 1px solid rgb(217, 217, 217); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace, Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.eoOutputWrapper { width: calc(90vw - 10px) !important; }
.S12 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 1px solid rgb(217, 217, 217); border-bottom: 1px solid rgb(217, 217, 217); border-radius: 4px 4px 0px 0px; padding: 6px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace, Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S13 { color: rgb(33, 33, 33); padding: 10px 0px 6px 17px; background: rgb(255, 255, 255) none repeat scroll 0% 0% / auto padding-box border-box; font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px; overflow-x: hidden; line-height: 17.234px;  }
/* Styling that is common to warnings and errors is in diagnosticOutput.css */.embeddedOutputsErrorElement {    min-height: 18px;    max-height: 550px;}
.embeddedOutputsErrorElement .diagnosticMessage-errorType {    overflow: auto;}
.embeddedOutputsErrorElement.activeOutput .eoOutputContent {    user-select: text;    -webkit-user-select: text;}
.embeddedOutputsErrorElement.activeOutput .eoOutputContent button {    user-select: none;    -webkit-user-select: none;}
.embeddedOutputsErrorElement .eoOutputContent ::selection {}
.embeddedOutputsErrorElement.inlineElement {}
.embeddedOutputsErrorElement.rightPaneElement {}
/* Styling that is common to warnings and errors is in diagnosticOutput.css */.embeddedOutputsWarningElement {    min-height: 18px;    max-height: 550px;}
.embeddedOutputsWarningElement .diagnosticMessage-warningType {    overflow: auto;}
.embeddedOutputsWarningElement.activeOutput .eoOutputContent {    user-select: text;    -webkit-user-select: text;}
.embeddedOutputsWarningElement .eoOutputContent ::selection {}
.embeddedOutputsWarningElement.inlineElement {}
.embeddedOutputsWarningElement.rightPaneElement {}
/* Copyright 2015-2023 The MathWorks, Inc. *//* In this file, styles are not scoped to rtcContainer since they could be in the Dojo Tooltip */.diagnosticMessage-wrapper {    font-family: Menlo, Monaco, Consolas, "Courier New", monospace;    font-size: 12px;}
.diagnosticMessage-wrapper.diagnosticMessage-warningType {    /*This fallback value will be used for appdesigner warnings*/    color: var(--rtc-warning-output-color, var(--mw-color-matlabWarning));}
.diagnosticMessage-wrapper.diagnosticMessage-warningType a {    /*This fallback value will be used for appdesigner warnings*/    color: var(--rtc-warning-output-color, var(--mw-color-matlabWarning));    text-decoration: underline;}
.rtcThemeDefaultOverride .diagnosticMessage-wrapper.diagnosticMessage-warningType,.rtcThemeDefaultOverride .diagnosticMessage-wrapper.diagnosticMessage-warningType a {    color: var(--mw-color-matlabWarning) !important;}
.diagnosticMessage-wrapper.diagnosticMessage-errorType {    /*This fallback value will be used in appdesigner error tooltip text*/    color: var(--rtc-error-output-color, var(--mw-color-matlabErrors));}
.diagnosticMessage-wrapper.diagnosticMessage-errorType a {    /*This fallback value will be used in appdesigner error tooltip text*/    color: var(--rtc-error-output-color, var(--mw-color-matlabErrors));    text-decoration: underline;}
.rtcThemeDefaultOverride .diagnosticMessage-wrapper.diagnosticMessage-errorType,.rtcThemeDefaultOverride .diagnosticMessage-wrapper.diagnosticMessage-errorType a {    color: var(--mw-color-matlabErrors) !important;}
.diagnosticMessage-wrapper .diagnosticMessage-messagePart,.diagnosticMessage-wrapper .diagnosticMessage-causePart {    white-space: pre-wrap;}
.diagnosticMessage-wrapper .diagnosticMessage-stackPart {    white-space: pre;}
.embeddedOutputsTextElement,.embeddedOutputsVariableStringElement {    white-space: pre;    word-wrap:  initial;    min-height: 18px;    max-height: 550px;}
.embeddedOutputsTextElement .textElement,.embeddedOutputsVariableStringElement .textElement {    overflow: auto;}
.embeddedOutputsTextElement.activeOutput .eoOutputContent,.embeddedOutputsVariableStringElement.activeOutput .eoOutputContent {    user-select: text;    -webkit-user-select: text;}
/*embeddedOutputsTextElement has a different dom structure than embeddedOutputsVariableStringElement.Unlike variableString, the text output has both TEXT nodes and elements as children. Hence we needa selector for each.*/.embeddedOutputsTextElement .eoOutputContent::selection,.embeddedOutputsTextElement .eoOutputContent ::selection,.embeddedOutputsVariableStringElement .eoOutputContent ::selection {}
.textElement,.rtcDataTipElement .textElement {    padding-top: 2px;}
.embeddedOutputsTextElement.inlineElement,.embeddedOutputsVariableStringElement.inlineElement {}
.inlineElement .textElement {}
.embeddedOutputsTextElement.rightPaneElement,.embeddedOutputsVariableStringElement.rightPaneElement {    min-height: 16px;}
.rightPaneElement .textElement {    padding-top: 2px;    padding-left: 9px;}
.S14 { margin: 10px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif, Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S15 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 1px solid rgb(217, 217, 217); border-bottom: 1px solid rgb(217, 217, 217); border-radius: 4px; padding: 6px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace, Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }</style></head><body><div class = rtcContent><h1  class = 'S0' id = 'H_65cd' ><span>Data export</span></h1><div  class = 'S1'><span>To open this page as a Matlab live script, run the command</span></div><div class = 'preformatted-matlab' style = 'margin: 10px 3px 10px 55px; padding: 10px 10px 10px 5px; '><div  class = 'S2'><span style="white-space: pre"><span >open(which(</span><span style="color: #a709f5;">"tutorial_export_01.mlx"</span><span >))</span></span></div></div><div  class = 'S1'><span>At one point or another, you will want to get your data out of the Matlab environment. drEEM supports exporting of:</span></div><ol  class = 'S3'><li  class = 'S4'><span>The data (as csv files)</span></li><li  class = 'S4'><span>A model (as spreadsheet file)</span></li><li  class = 'S4'><span>The model for upload in OpenFluor (as text file)</span></li></ol><div  class = 'S1'><span>The relevant functions all start with the term "export", so they should be easy to find if you use the toolbox handle, then type exp and hit the tab key (⇥), for example</span></div><div class = 'preformatted-matlab' style = 'margin: 10px 3px 10px 55px; padding: 10px 10px 10px 5px; '><div  class = 'S2'><span style="white-space: pre"><span >drEEMtoolbox.exp (then hit the </span><span style="color: rgb(225, 27, 20);">⇥ </span><span >key)</span></span></div></div><div  class = 'S5'><div  class = 'S6'><span style=' font-weight: bold;'>Table of Contents</span></div><div  class = 'S7'><a href = "#H_5d06"><span>Toolbox setup and data loading
</span></a><a href = "#H_40e8"><span>Export the data
</span></a><a href = "#H_6e0c"><span>Export the model
</span></a><a href = "#H_66f8"><span>Export the model in OpenFluor format</span></a></div></div><h2  class = 'S8' id = 'H_5d06' ><span>Toolbox setup and data loading</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >clearvars</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >close </span><span style="color: #a709f5;">all force</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >cd(fileparts(matlab.desktop.editor.getActiveFilename))</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >tbx=drEEMtoolbox;</span></span></div></div><div class="inlineWrapper"><div  class = 'S11'><span style="white-space: pre"><span >load(</span><span style="color: #a709f5;">'tutorial_parafac_modelled.mat'</span><span >)</span></span></div></div></div><h2  class = 'S8' id = 'H_40e8' ><span>Export the data</span></h2><div  class = 'S1'><span>Open research data is an important part of </span><a href = "https://en.wikipedia.org/wiki/Open_science"><span>Open Science</span></a><span> and we support you to make this as easy as possible. If you wish to export all of your EEM and absorbance data, you can use </span><span style=' font-family: monospace;'>export2zip</span><span> to create an archive version of the dataset. Each sample's EEM and absorbance spectrum is exported as csv file with the wavelength information. The dataset's history is saved, along with it's status, CDOM absorbance slopes, Coble peaks, and scatter removal settings. The archive also contains information on the toolbox and Matlab version and a readme.txt file to explain the contents. For convenience of Matlab users, the .mat-file is also saved.</span></div><div class="CodeBlock"><div class="inlineWrapper outputs"><div  class = 'S12'><span style="white-space: pre"><span >tbx.export2zip(newSamples,</span><span style="color: #a709f5;">'tutorial_data.zip'</span><span >)</span></span></div><div  class = 'S13'><div class="inlineElement eoOutputWrapper disableDefaultGestureHandling embeddedOutputsTextElement" uid="57CE619E" prevent-scroll="true" data-testid="output_0" style="width: 859px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;" tabindex="-1"><div class=" textElement eoOutputContent" data-previous-available-width="822" data-previous-scroll-height="17" data-hashorizontaloverflow="false" role="article" aria-roledescription="Use Browse Mode to explore " aria-description="text output " style="max-height: 261px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;" tabindex="-1">Scaling reversed.</div></div></div></div></div><div  class = 'S14' id = 'H_8c68' ><span>It's as easy as that. Now you could send this to collaborators, submit it along with your publication, or simply store it for later use. Even if the scripts get lost, you would still know what happened to this data. Think of pairing this export with an export directly after the data import. Then, if worst comes to worst, you could even recreate the final dataset by combining the raw data archive with the information from the export file at the end of the analyisis above.</span></div><h2  class = 'S8' id = 'H_6e0c' ><span>Export the model</span></h2><div  class = 'S1'><span>You might also want to export the PARAFAC modeling results to a spreadsheet to analyze in Excel or other statistical programming environments.</span></div><div class="CodeBlock"><div class="inlineWrapper outputs"><div  class = 'S12'><span style="white-space: pre"><span >tbx.exportresults(newSamples,5,</span><span style="color: #a709f5;">'tutorialModelExport'</span><span >);</span></span></div><div  class = 'S13'><div class="inlineElement eoOutputWrapper disableDefaultGestureHandling embeddedOutputsTextElement" uid="DBEA8651" prevent-scroll="true" data-testid="output_1" style="width: 859px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;" tabindex="-1"><div class="textElement eoOutputContent" data-previous-available-width="822" data-previous-scroll-height="164" data-hashorizontaloverflow="false" style="max-height: 261px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;" role="article" aria-roledescription="Use Browse Mode to explore " aria-description="text output " tabindex="-1">Scaling reversed.
 
<strong style="white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"> Writing to file: /Users/urban/Documents/MATLAB/drEEM-2.0/documentation/tutorialModelExport.xlsx</strong>
    Finished spreadsheet: dataset history
    Finished spreadsheet: dataset status
    Finished spreadsheet: scatter treatment
    Finished spreadsheet: Peaks &amp; indicies
    Finished spreadsheet: PARAFAC model overview
    Finished spreadsheet: Split-validation approach
    Finished spreadsheets for selected PARAFAC model (scores and loadings)
<strong style="white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"> Success! Done with result export.</strong></div></div></div></div></div><div  class = 'S14'><span>There's no nice way to open spreadsheets in your System's spreadsheet editor, but this below will open Matlab's Import wizard which you can use to browse the file content. Otherwise, just find the file in the File exlorer (usually at the left side of the Matlab environment) and select "Open Outside Matlab".</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S15'><span style="white-space: pre"><span >open(</span><span style="color: #a709f5;">"tutorialModelExport.xlsx"</span><span >)</span></span></div></div></div><h2  class = 'S8' id = 'H_66f8' ><span>Export the model in OpenFluor format</span></h2><div  class = 'S1'><span>At the end of the PARAFAC tutorial we had obtained a validated model and we would propably want to analyze it. You'd probably want to know how this model compares against what's out there. So let's get a .txt file that can be uploaded to OpenFluor.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S15'><span style="white-space: pre"><span >tbx.export2openfluor(newSamples,5,</span><span style="color: #a709f5;">'tutorial2openFluor.txt'</span><span >)</span></span></div></div></div>
<br>
<!-- 
##### SOURCE BEGIN #####
%% Data export
% To open this page as a Matlab live script, run the command
%%
% 
%   open(which("tutorial_export_01.mlx"))
%
%% 
% At one point or another, you will want to get your data out of the Matlab 
% environment. drEEM supports exporting of:
%% 
% # The data (as csv files)
% # A model (as spreadsheet file)
% # The model for upload in OpenFluor (as text file)
%% 
% The relevant functions all start with the term "export", so they should be 
% easy to find if you use the toolbox handle, then type exp and hit the tab key 
% (⇥), for example
%%
% 
%   drEEMtoolbox.exp (then hit the ⇥ key)
%
%% Toolbox setup and data loading

clearvars
close all force
cd(fileparts(matlab.desktop.editor.getActiveFilename))
tbx=drEEMtoolbox;
load('tutorial_parafac_modelled.mat')
%% Export the data
% Open research data is an important part of <https://en.wikipedia.org/wiki/Open_science 
% Open Science> and we support you to make this as easy as possible. If you wish 
% to export all of your EEM and absorbance data, you can use |export2zip| to create 
% an archive version of the dataset. Each sample's EEM and absorbance spectrum 
% is exported as csv file with the wavelength information. The dataset's history 
% is saved, along with it's status, CDOM absorbance slopes, Coble peaks, and scatter 
% removal settings. The archive also contains information on the toolbox and Matlab 
% version and a readme.txt file to explain the contents. For convenience of Matlab 
% users, the .mat-file is also saved.

tbx.export2zip(newSamples,'tutorial_data.zip')
%% 
% It's as easy as that. Now you could send this to collaborators, submit it 
% along with your publication, or simply store it for later use. Even if the scripts 
% get lost, you would still know what happened to this data. Think of pairing 
% this export with an export directly after the data import. Then, if worst comes 
% to worst, you could even recreate the final dataset by combining the raw data 
% archive with the information from the export file at the end of the analyisis 
% above.
%% Export the model
% You might also want to export the PARAFAC modeling results to a spreadsheet 
% to analyze in Excel or other statistical programming environments.

tbx.exportresults(newSamples,5,'tutorialModelExport');
%% 
% There's no nice way to open spreadsheets in your System's spreadsheet editor, 
% but this below will open Matlab's Import wizard which you can use to browse 
% the file content. Otherwise, just find the file in the File exlorer (usually 
% at the left side of the Matlab environment) and select "Open Outside Matlab".

open("tutorialModelExport.xlsx")
%% Export the model in OpenFluor format
% At the end of the PARAFAC tutorial we had obtained a validated model and we 
% would propably want to analyze it. You'd probably want to know how this model 
% compares against what's out there. So let's get a .txt file that can be uploaded 
% to OpenFluor.

tbx.export2openfluor(newSamples,5,'tutorial2openFluor.txt')
##### SOURCE END #####
-->
</div></body></html>