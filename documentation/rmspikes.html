<!DOCTYPE html>
<html>

<head>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>rmspikes</title>


<style type="text/css">
/* CSS stylesheet for drEEM toolbox documentatio */
/* Author: Urban WÃ¼nsch */

/* RESET
=============================================================================*/

html, body, div, span, applet, object, iframe, h1, h2, h3, h4, h5, h6, p, blockquote, pre, a, abbr, acronym, address, big, cite, code, del, dfn, em, img, ins, kbd, q, s, samp, small, strike, strong, sub, sup, tt, var, b, u, i, center, dl, dt, dd, ol, ul, li, fieldset, form, label, legend, table, caption, tbody, tfoot, thead, tr, th, td, article, aside, canvas, details, embed, figure, figcaption, footer, header, hgroup, menu, nav, output, ruby, section, summary, time, mark, audio, video {
  margin: 0;
  padding: 0;
  border: 0;
}

/* BODY
=============================================================================*/

body {
  font-family: Tahoma,sans-serif, Helvetica, arial, freesans, clean;
  font-size: 14px;
  line-height: 1.6;
  color: #404040;
  background-color: #fff;
  padding: 20px;
  max-width: 960px;
  margin: 0 auto;
}

body>*:first-child {
  margin-top: 0 !important;
}

body>*:last-child {
  margin-bottom: 0 !important;
}

/* BLOCKS
=============================================================================*/

p, blockquote, ul, ol, dl, table, pre {
  margin: 15px 0;
}

/* HEADERS
=============================================================================*/

h1, h2, h3, h4, h5, h6 {
  margin: 20px 0 10px;
  padding: 0;
  font-weight: bold;
  -webkit-font-smoothing: antialiased;
}

h1 tt, h1 code, h2 tt, h2 code, h3 tt, h3 code, h4 tt, h4 code, h5 tt, h5 code, h6 tt, h6 code {
  font-size: inherit;
}

h1 {
  font-family: Tahoma;
  font-size: 28px;
  border-bottom: 1px solid #ccc;
  color: #c05708;
}

h2 {
  font-size: 24px;
  color: #404040;
  border-bottom: 1px solid #ccc;
}

h3 {
  font-size: 16px;
  font-family: Consolas, "Liberation Mono", Courier, monospace;
  color: #404040;
  font-weight: bold;
  margin: 0 0px;
  padding: 0px 0px;
  white-space: nowrap;
  border: 1px solid #fcfcfc;
  background-color: #fcfcfc;
  border-radius: 3px;
}

h4 {
  font-size: 16px;
  white-space: nowrap;
  border: 1px solid #ececec;
  background-color: #f9f9f9;
  border-radius: 4px;
  margin: 20px 0 10px;
}

h5 {
  font-size: 20px;
  color: #c05708;
}

h6 {
  color: #777;
  font-size: 14px;
}

body>h2:first-child, body>h1:first-child, body>h1:first-child+h2, body>h3:first-child, body>h4:first-child, body>h5:first-child, body>h6:first-child {
  margin-top: 0;
  padding-top: 0;
}

a:first-child h1, a:first-child h2, a:first-child h3, a:first-child h4, a:first-child h5, a:first-child h6 {
  margin-top: 0;
  padding-top: 0;
}

h1+p, h2+p, h3+p, h4+p, h5+p, h6+p {
  margin-top: 10px;
}

/* LINKS
=============================================================================*/

a {
  font-familiy: Verdana;
  color: #0076a8;
  text-decoration: none;
  font-weight: bold;
}

a:hover {
  text-decoration: underline;
}

/* LISTS
=============================================================================*/

ul, ol {
  padding-left: 30px;
}

ul li > :first-child, 
ol li > :first-child, 
ul li ul:first-of-type, 
ol li ol:first-of-type, 
ul li ol:first-of-type, 
ol li ul:first-of-type {
  margin-top: 0px;
}

ul ul, ul ol, ol ol, ol ul {
  margin-bottom: 0;
}

dl {
  padding: 0;
}

dl dt {
  font-size: 14px;
  font-weight: bold;
  font-style: italic;
  padding: 0;
  margin: 15px 0 5px;
}

dl dt:first-child {
  padding: 0;
}

dl dt>:first-child {
  margin-top: 0px;
}

dl dt>:last-child {
  margin-bottom: 0px;
}

dl dd {
  margin: 0 0 15px;
  padding: 0 15px;
}

dl dd>:first-child {
  margin-top: 0px;
}

dl dd>:last-child {
  margin-bottom: 0px;
}

/* CODE
=============================================================================*/

pre, code, tt {
  font-size: 16px;
  font-family: Consolas, "Liberation Mono", Courier, monospace;
  color: #404040;
  font-weight: bold;
}

code, tt {
  margin: 0 0px;
  padding: 0px 0px;
  white-space: nowrap;
  border: 1px solid #fcfcfc;
  background-color: #f8f8ff;
  border:1px solid #dedede;
  color:#444;
  border-radius: 3px;
}

pre>code {
  margin: 0;
  padding: 0;
  white-space: pre;
  border: none;
  background: transparent;
}

pre {
  background-color: #fcfcfc;
  border: 1px solid #fcfcfc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px;
}

pre code, pre tt {
  background-color: transparent;
  border: none;
}

kbd {
    -moz-border-bottom-colors: none;
    -moz-border-left-colors: none;
    -moz-border-right-colors: none;
    -moz-border-top-colors: none;
    background-color: #DDDDDD;
    background-image: linear-gradient(#F1F1F1, #DDDDDD);
    background-repeat: repeat-x;
    border-color: #DDDDDD #CCCCCC #CCCCCC #DDDDDD;
    border-image: none;
    border-radius: 2px 2px 2px 2px;
    border-style: solid;
    border-width: 1px;
    font-family: "Helvetica Neue",Helvetica,Arial,sans-serif;
    line-height: 10px;
    padding: 1px 4px;
}

/* QUOTES
=============================================================================*/

blockquote {
  border-left: 4px solid #DDD;
  padding: 0 15px;
  color: #777;
}

blockquote>:first-child {
  margin-top: 0px;
}

blockquote>:last-child {
  margin-bottom: 0px;
}

/* HORIZONTAL RULES
=============================================================================*/

hr {
  clear: both;
  margin: 15px 0;
  height: 0px;
  overflow: hidden;
  border: none;
  background: transparent;
  border-bottom: 4px solid #ddd;
  padding: 0;
}

/* TABLES
=============================================================================*/

table th {
  font-weight: bold;
}

table th, table td {
  border: 1px solid #ccc;
  padding: 6px 13px;
}

table tr {
  border-top: 1px solid #ccc;
  background-color: #fff;
}

table tr:nth-child(2n) {
  background-color: #f8f8f8;
}

/* IMAGES
=============================================================================*/

img {
  max-width: 100%
}
</style>


</head>

<body>

<p><img src="top right corner logo.png" width="100" height="auto" align="right"/></p>

<h1 id="toc_0">rmspikes</h1>

<p>Removes spikes from fluorescence excitation-emission matrix (EEM) data by identifying and interpolating over noisy data points.</p>

<h2 id="toc_1">Syntax</h2>

<h3 id="toc_2"><a href="#syntax1">dataout = rmspikes(data)</a></h3>

<p>Run the noise removal function with default settings.</p>

<h3 id="toc_3"><a href="#syntax1">dataout = rmspikes( ___ , Name,Value)</a></h3>

<p>Run the noise removal function with custom settings.</p>

<h3 id="toc_4"><a href="#syntax1">rmspikes( ___ , Name,Value)</a></h3>

<p>Run the noise removal function in diagnostics mode to finetune settings. Pairs well with <code>details=true</code>. Here, no output will be assigned since testing is the purpose.</p>

<h2 id="toc_5">Description</h2>

<h3 id="toc_6"><a href="#varargout">dataout</a> = rmspikes(<a href="#varargin">data</a>) <a name="syntax1"></a></h3>

<p>The function  <code>rmspikes</code> automatically extracts the EEM  from <code>data</code> and alternatingly deletes parts of the excitation and emission scans. The function then interpolates over the alternatingly-deleted data using <code>&#39;inpaint&#39;</code> method. Then calculates differences between the original and interpolated data to identify spikes and according to the default <code>threshold</code> removes spikes by setting the corresponding data points to NaN. The function provides warnings if a significant portion of the data is identified as noisy.
<code>rsmpikes</code> can optionally interpolate over the removed spikes.</p>

<blockquote>
<h3 id="toc_7"><a href="#varargout">dataout</a> = rmspikes(<a href="#varargin"> ___ , Name,Value</a>) <a name="syntax1"></a></h3>

<p>specifies additional options using one or more name-value pair arguments. For example, you can specify if <code>interpoaltion</code> should be performed or adjust the <code>thresholdFactor</code>. <br>
Example: <code>rmspikes(data, &quot;interpolate&quot;,1, &quot;thresholdFactor&quot;,100, &quot;details&quot;,true, &quot;plot&quot;,false)</code> to remove the spikes using a threshold of <code>100</code>, interpolate the removed data, and only plot the <code>details</code>. </p>
</blockquote>

<h2 id="toc_8">Input arguments</h2>

<h4 id="toc_9">data - drEEMdataset to remove the spikes from  <a name="varargin"></a> <br> Type: drEEMdataset class object</h4>

<p>Dataset of the class <code>drEEMdataset</code>, with standardized contents and automated validation methods that will be fed to <code>rmspikes</code>.</p>

<h5 id="toc_10">Name-Value Arguments  <a name="data"></a></h5>

<p>Specify optional pairs of arguments as <code>Name1=Value1,...,NameN=ValueN</code>, where <code>Name</code> is the argument name and <code>Value</code> is the corresponding value. Name-value arguments must appear after other arguments, <code>data</code> in this case, but the order of the pairs does not matter. </p>

<p>Example: <code>___,&quot;interpolate&quot;,false, &quot;thresholdFactor&quot;,40, &quot;details&quot;,true</code> specifies that function is expected to remove spikes with a threshhold factor of <code>40</code> without doing an interpolation over the missing values and then plot the <code>details</code>. Other arguments will use their default values.</p>

<h4 id="toc_11">thresholdFactor - specify the sensitivity of the function to spikes  <a name="varargin"></a> <br> Type:  numeric</h4>

<p>Adjust the sensitivity of the spike detection. A lower values means more sensitivity. Default is <code>10</code>. </p>

<h4 id="toc_12">interpolate - specify if the removed values should be interpolated  <a name="varargin"></a> <br> Type:  numeric | logical</h4>

<p>Logical or numeric value to specify if interpolation over removed data points should be performed. Default is <code>false</code>.</p>

<h4 id="toc_13">plot - specify if the removal overview plot should be displayed  <a name="varargin"></a> <br> Type:  numeric | logical</h4>

<p>Logical or numeric value to specify if a plot showing the results should be generated. The plot shows noise threshold profile along excitation mode and the percentage removal of data in excitation and emission modes.
Default is <code>true</code>.</p>

<h4 id="toc_14">details - specify if detailed plots should be displayed  <a name="varargin"></a> <br> Type:  numeric | logical</h4>

<p>Logical or numeric value to specify if detailed diagnostic plots should be shown for each sample. This plot depicts original and final EEMs, original EEM with marked removal points and, finally, the difference between original data and smoothed data.
Default is <code>false</code>.</p>

<h2 id="toc_15">Output arguments (optional)</h2>

<h4 id="toc_16">dataout - drEEMdataset with removed spikes  <a name="varargin"></a> <br> Type: drEEMdataset class object</h4>

<p>Dataset of the class <code>drEEMdataset</code>, with standardized contents and automated validation methods, in which the spikes are removed according to the specified options (these <code>options</code> are stored in the <code>history</code> field of the <code>dataout</code>). If no output argument is specified, the function overwrites the original object, <code>data</code>, in the workspace.</p>

<h2 id="toc_17">Algorithms</h2>

<ol>
<li><strong>&#39;inpaint&#39;</strong> interpolation method applies del^2 over the entire array, then drops those parts of the array which do not have any contact with NaNs. &#39;<code>inpaint&#39;</code> uses a least squares approach, but it does not modify known values. In the case of small arrays, this method is quite fast as it does very little extra work. Extrapolation behavior is linear. See inpaint: Copyright (c) 2017, Damien Garcia.</li>
</ol>

<h2 id="toc_18">See Also</h2>

<p><a href="link.com">handlescatter</a> | 
<a href="link.com"> Link2 </a> |
<a href="link.com"> Link3 </a> |</p>

<h2 id="toc_19">Topics</h2>




</body>

</html>
