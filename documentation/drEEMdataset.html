<!DOCTYPE html>
<html>
<head>
<title>drEEMdataset</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<style type="text/css">
/* CSS stylesheet for drEEM toolbox documentatio */
/* Author: Urban Wünsch */

/* RESET
=============================================================================*/

html, body, div, span, applet, object, iframe, h1, h2, h3, h4, h5, h6, p, blockquote, pre, a, abbr, acronym, address, big, cite, code, del, dfn, em, img, ins, kbd, q, s, samp, small, strike, strong, sub, sup, tt, var, b, u, i, center, dl, dt, dd, ol, ul, li, fieldset, form, label, legend, table, caption, tbody, tfoot, thead, tr, th, td, article, aside, canvas, details, embed, figure, figcaption, footer, header, hgroup, menu, nav, output, ruby, section, summary, time, mark, audio, video {
  margin: 0;
  padding: 0;
  border: 0;
}

/* BODY
=============================================================================*/

body {
  font-family: Tahoma,sans-serif, Helvetica, arial, freesans, clean;
  font-size: 14px;
  line-height: 1.6;
  color: #404040;
  background-color: #fff;
  padding: 20px;
  max-width: 960px;
  margin: 0 auto;
}

body>*:first-child {
  margin-top: 0 !important;
}

body>*:last-child {
  margin-bottom: 0 !important;
}

/* BLOCKS
=============================================================================*/

p, blockquote, ul, ol, dl, table, pre {
  margin: 15px 0;
}

/* HEADERS
=============================================================================*/

h1, h2, h3, h4, h5, h6 {
  margin: 20px 0 10px;
  padding: 0;
  font-weight: bold;
  -webkit-font-smoothing: antialiased;
}

h1 tt, h1 code, h2 tt, h2 code, h3 tt, h3 code, h4 tt, h4 code, h5 tt, h5 code, h6 tt, h6 code {
  font-size: inherit;
}

h1 {
  font-family: Tahoma;
  font-size: 28px;
  border-bottom: 1px solid #ccc;
  color: #c05708;
}

h2 {
  font-size: 24px;
  color: #404040;
  border-bottom: 1px solid #ccc;
}

h3 {
  font-size: 16px;
  font-family: Consolas, "Liberation Mono", Courier, monospace;
  color: #404040;
  font-weight: bold;
  margin: 0 0px;
  padding: 0px 0px;
  white-space: nowrap;
  border: 1px solid #fcfcfc;
  background-color: #fcfcfc;
  border-radius: 3px;
}

h4 {
  font-size: 16px;
  white-space: nowrap;
  border: 1px solid #ececec;
  background-color: #f9f9f9;
  border-radius: 4px;
  margin: 20px 0 10px;
}

h5 {
  font-size: 20px;
  color: #c05708;
}

h6 {
  color: #777;
  font-size: 14px;
}

body>h2:first-child, body>h1:first-child, body>h1:first-child+h2, body>h3:first-child, body>h4:first-child, body>h5:first-child, body>h6:first-child {
  margin-top: 0;
  padding-top: 0;
}

a:first-child h1, a:first-child h2, a:first-child h3, a:first-child h4, a:first-child h5, a:first-child h6 {
  margin-top: 0;
  padding-top: 0;
}

h1+p, h2+p, h3+p, h4+p, h5+p, h6+p {
  margin-top: 10px;
}

/* LINKS
=============================================================================*/

a {
  font-familiy: Verdana;
  color: #0076a8;
  text-decoration: none;
  font-weight: bold;
}

a:hover {
  text-decoration: underline;
}

/* LISTS
=============================================================================*/

ul, ol {
  padding-left: 30px;
}

ul li > :first-child, 
ol li > :first-child, 
ul li ul:first-of-type, 
ol li ol:first-of-type, 
ul li ol:first-of-type, 
ol li ul:first-of-type {
  margin-top: 0px;
}

ul ul, ul ol, ol ol, ol ul {
  margin-bottom: 0;
}

dl {
  padding: 0;
}

dl dt {
  font-size: 14px;
  font-weight: bold;
  font-style: italic;
  padding: 0;
  margin: 15px 0 5px;
}

dl dt:first-child {
  padding: 0;
}

dl dt>:first-child {
  margin-top: 0px;
}

dl dt>:last-child {
  margin-bottom: 0px;
}

dl dd {
  margin: 0 0 15px;
  padding: 0 15px;
}

dl dd>:first-child {
  margin-top: 0px;
}

dl dd>:last-child {
  margin-bottom: 0px;
}

/* CODE
=============================================================================*/

pre, code, tt {
  font-size: 16px;
  font-family: Consolas, "Liberation Mono", Courier, monospace;
  color: #404040;
  font-weight: bold;
}

code, tt {
  margin: 0 0px;
  padding: 0px 0px;
  white-space: nowrap;
  border: 1px solid #fcfcfc;
  background-color: #fcfcfc;
  border-radius: 3px;
}

pre>code {
  margin: 0;
  padding: 0;
  white-space: pre;
  border: none;
  background: transparent;
}

pre {
  background-color: #fcfcfc;
  border: 1px solid #fcfcfc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px;
}

pre code, pre tt {
  background-color: transparent;
  border: none;
}

kbd {
    -moz-border-bottom-colors: none;
    -moz-border-left-colors: none;
    -moz-border-right-colors: none;
    -moz-border-top-colors: none;
    background-color: #DDDDDD;
    background-image: linear-gradient(#F1F1F1, #DDDDDD);
    background-repeat: repeat-x;
    border-color: #DDDDDD #CCCCCC #CCCCCC #DDDDDD;
    border-image: none;
    border-radius: 2px 2px 2px 2px;
    border-style: solid;
    border-width: 1px;
    font-family: "Helvetica Neue",Helvetica,Arial,sans-serif;
    line-height: 10px;
    padding: 1px 4px;
}

/* QUOTES
=============================================================================*/

blockquote {
  border-left: 4px solid #DDD;
  padding: 0 15px;
  color: #777;
}

blockquote>:first-child {
  margin-top: 0px;
}

blockquote>:last-child {
  margin-bottom: 0px;
}

/* HORIZONTAL RULES
=============================================================================*/

hr {
  clear: both;
  margin: 15px 0;
  height: 0px;
  overflow: hidden;
  border: none;
  background: transparent;
  border-bottom: 4px solid #ddd;
  padding: 0;
}

/* TABLES
=============================================================================*/

table th {
  font-weight: bold;
}

table th, table td {
  border: 1px solid #ccc;
  padding: 6px 13px;
}

table tr {
  border-top: 1px solid #ccc;
  background-color: #fff;
}

table tr:nth-child(2n) {
  background-color: #f8f8f8;
}

/* IMAGES
=============================================================================*/

img {
  max-width: 100%
}
</style>
</head>
<body>
<img src="top right corner logo.png" width="100" height="auto" align="right"/>
<h1>The drEEMdataset object</h1>
<p>Processing of multidimensional data can be a mess. Decisions on how to organize the data need to be made, variable names set, and conventions made. Often, functions don't work as intended because the input they were provided with isn't formatted as expected.</p>
<p>Another problem arises when considering the need for tracability. When loading a dataset, it's not clear what it's status is. Have blanks been subtracted? Who performed the spectral correction (was it even done?)? What about inner-filter effects?</p>
<p>Meet the <code>drEEMdataset object</code>!</p>
<p>Starting in drEEM 2, we made the decision to define what's known as a <code>class</code> in Matlab notation. We call this the <code>drEEMdataset</code>. It has a defined number of properties (i.e. variables). Nothing else is allowed to be added. And anytime a function is called, the dataset get's validated to avoid errors.</p>
<p>You can still manually modify the data of course if you wish to do so! But when you intend to work with drEEM, you must work with datasets of the custom <code>drEEMdataset</code> class.</p>
<p>This page aims to show the properties, highlight some ways to work with it, and demonstrate its advantages.</p>
<p>First, let's look at all the properties of the <code>drEEMdataset</code>. You can see these by simply calling the class. This results in an empty dataset being created.</p>
<pre><code>&gt;&gt; drEEMdataset

ans = 

drEEMdataset with properties:

        history: [0×1 drEEMhistory]
              X: []
            abs: []
    suppSpectra: []
       filelist: {0×1 cell}
              i: [0×1 double]
             Ex: [0×1 double]
             Em: [0×1 double]
            nEx: 0
            nEm: 0
        absWave: [0×1 double]
suppSpectraAxis: [0×1 double]
        nSample: 0
         models: [0×1 drEEMmodel]
       metadata: [0×0 table]
opticalMetadata: [0×0 table]
          split: [0×0 drEEMdataset]
         status: [1×1 drEEMstatus]
       userdata: []
 instrumentInfo: [0×0 struct]
measurementInfo: [0×0 struct]
    toolboxdata: [] 
</code></pre>

<h2>Properties</h2>
<p>You can see above that there are tons of properties (i.e. variables) in the object. Many of these could be familiar from previous use of drEEM or DOMFluor, but many are also new. We will run through them.</p>
<ul>
<li><strong>history</strong>: This is an object of it's own class (sorry to be complicated here). But you don't really need to know much about other than it keeps a memory about the history of the dataset. Every time you call a drEEM function, it creates an entry, saves it's options there, perhaps makes a function message, and stores backups in a few cases. This object gets exported along with the dataset to let everybody know what happened to the dataset. This is also the place where your own comments get stored.</li>
<li><strong>X</strong>: The fluorescence dataset (samples x emission x excitation).</li>
<li><strong>abs</strong>: The absorbance dataset (samples x absorbance)</li>
<li><strong>suppSpectra</strong>: Mostly a placeholder (&quot;supplemental spectra&quot;). You could store other kinds of spectra in here to do some cool stuff like data fusion. For example, mass spectra could go here!</li>
<li><strong>filelist</strong>: This is a cell array of characters. The toolbox uses this variable to know what to call your samples. I.e. file names, sample names, sample IDs (whatever you'd call it)</li>
<li><strong>i</strong>: The sample identifier. This starts out as a simple vector with as many numbers as you have samples. But when you delete samples, i=2 might disappear from the list. Don't work with indexes, work with .i to avoid ambiguity in your programming. <code>data.i==2</code> will always work as intented, <code>data.X(2,:,:)</code> will refer to different samples if you change stuff!</li>
<li><strong>Ex</strong>: The excitation wavelengths, stored as a column vector. Always stored as increasing numbers.</li>
<li><strong>Em</strong>: The emission wavelengths, stored as a column vector. Always stored as increasing numbers.</li>
<li><strong>nEx</strong>: The number of excitation wavelengths, stored as an integer. </li>
<li><strong>nEm</strong>: The number of emission wavelengths, stored as an integer. </li>
<li><strong>absWave</strong>: The absorbance wavelengths, stored as a column vector. Always stored as increasing numbers.</li>
<li><strong>suppSpectraAxis</strong>: The axis information for the variable <code>suppSpectra</code>, stored as a column vector. Not actively used by the drEEM toolbox as of version 2.0.0</li>
<li><strong>nSample</strong>: The number of samples. Equal to <code>size(X,1)</code> and <code>size(abs,1)</code>.</li>
<li><strong>models</strong>: Yet another class of it's own. This is where potential PARAFAC models get stored. All of the model's properties are stored in here. No need to know much about it, because you'll access the object with e.g. <a href="viewmodels.html">viewmodels</a></li>
<li><strong>metadata</strong>: A table containing relevant metadata. Could be anything, temperature, salinity, location, lat/lon, analysis date, sampling date, person handling the samples, replicate #. You name it. The toolbox knows about this table and will offer the data in functions where it's relevant.</li>
<li><strong>opticalMetadata</strong>: A table dedicated to Cople peaks (<a href="pickpeaks.html">pickpeaks</a>) and CDOM absorbance slopes (<a href="fitslopes">fitslopes</a>). If you want to analyze them, just extract this table from the dataset.</li>
<li><strong>split</strong>: Here's where the split datasets will reside when you create them. They are each their own drEEMdataset objects and work in the same way as the parent dataset.</li>
<li>
<p><strong>status</strong>. This is a read-only variable. It stores the information about the status of the dataset:
	&gt;&gt; drEEMstatus</p>
<pre><code>ans = 

  drEEMstatus with properties:

    spectralCorrection: &quot;unknown&quot;
         IFEcorrection: &quot;unknown&quot;
      blankSubtraction: &quot;unknown&quot;
     signalCalibration: &quot;unknown&quot;
      scatterTreatment: &quot;unknown&quot;
         signalScaling: &quot;unknown&quot;
        absorbanceUnit: &quot;unknown&quot;
</code></pre>

<p>As you could guess from the names, each of these entries informs the toolbox about the dataset's status in regard to certain aspects. The functions will actually check and stop you from performing something if it makes no sense. The only way to change the status is through calling <code>drEEMtoolbox.changestatus()</code>. The GUI will give you valid options and you will have to chose what's appropriate. Any drEEM function that changes the status of the dataset will also change the status object!
This information will be exported along with the data or PARAFAC results.</p>
</li>
<li>
<p><strong>userdata</strong>. Not maintained by the toolbox and simply a placeholder. You could use this variable as a container for any data you'd want to imagine. It's there for you. If we didn't provide it but you'd want to make it yourself, Matlab would throw an error. Better have it and not need it...</p>
</li>
<li><strong>instrumentInfo</strong>: An unused placeholder. Room for future developments!</li>
<li><strong>toolboxdata</strong>: An unused placeholder. Room for future developments!</li>
</ul>

</body>
</html>
<!-- This document was created with MarkdownPad, the Markdown editor for Windows (http://markdownpad.com) -->
