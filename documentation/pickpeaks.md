<img src="top right corner logo.png" width="100" height="auto" align="right"/>

# pickpeaks #
Extract common fluorescence peaks (Cobel) and indices from a drEEMdataset object.




## Syntax
### [dataout, picklist, metadata = pickpeaks(data)](#syntax1) ###
Pickes predefined peaks and fluorescence indices in the EEM and stores the results in `dataout.opticalMetadata`.
### [dataout, picklist, metadata = pickpeaks( ___ , Name,Value)](#syntax1) ###

### [pickpeaks( ___ , Name,Value)](#syntax1) ###
Runs the function in diagnostics mode and does not assign an output variable. Use this to check the results or if you'd like to use the function with `details=true` before assigning the output at a later time.


## Description ##
### [dataout, picklist, metadata](#varargout) = pickpeaks([data](#varargin)) <a name="syntax1"></a>
Th function `pickpeaks` extracts predefined fluorescence peaks, including Peak B, T, A, M, C, D, and N, and computes several fluorescence indices, including Fluorescence index (FluI), Freshness Index (FrI), Biological Index (BIX) and Humification Index (HIX), from `data`. The peaks and indices will be plotted for all the samples in `data`.



>
### [dataout, picklist, metadata](#varargout) = pickpeaks([ ___ , Name,Value](#varargin)) <a name="syntax1"></a>
specifies additional options using one or more name-value pair arguments. For example, you can specify if the overview plot should be generated by using `'plot','true'` and specify if indices diagnostic plots should be displayed for each sample by using `'details','true'`. 





## Input arguments ##
#### data - drEEMdataset containing the fluorescence data  <a name="varargin"></a> <br> Type: drEEMdataset class object
Dataset of the class `drEEMdataset`, with standardized contents and automated validation methods.



##### Name-Value Arguments  <a name="data"></a>
Specify optional pairs of arguments as `Name1=Value1,...,NameN=ValueN`, where `Name` is the argument name and `Value` is the corresponding value. Name-value arguments must appear after other arguments, `data` in this case, but the order of the pairs does not matter. 


#### plot - specify if the overview plot should be displayed  <a name="varargin"></a> <br> Type:  numeric | logical
Logical or numeric value to specify if a plot showing the results should be generated. The plot shows an overview of peaks and indices values for all sample in `data`.
Default is `true`.

#### details - specify if diagnostic plots should be generated for indices calculation   <a name="varargin"></a> <br> Type:  numeric | logical
Logical or numeric value to specify if detailed diagnostic plots should be shown for each sample. Each plot will show the emission scan at the predefined excitation wavelength, with highlighted areas that are used in calculating the corresponding index.<br>
Default is `false`.




## Output arguments (optional)##
#### dataout - drEEMdataset with peaks and indices in metadata <a name="varargin"></a> <br> Type: drEEMdataset class object
A drEEMdataset object with updated table `opticalMetadata` including the extracted peaks and indices. If no output argument is specified, the function overwrites the original object, `data`, in the workspace.

#### picklist  - table containing peaks and indices for each sample <a name="varargin"></a> <br> Type: Table
A table containing the extracted peak values and calculated indices for each sample.

#### metadata  - table containing excitation and emission wavelength pairs <a name="varargin"></a> <br> Type: Table
A table containing the excitation and emission wavelengths pairs used for extracting peaks C and M for each sample.


## See Also ##

<a href="link.com"> Link1 </a> | 
<a href="link.com"> Link2 </a> |
<a href="link.com"> Link3 </a> |


## Topics ##
This section provides information on the peak extraction and the indices calculation process. The table at the end of the section contains a summary of the emission and excitation pairs used for each data point.<br>


1. **Peak Extraction:**<br>
	1. Single Point: The peak value is taken directly from the specified Em/Ex pair.
	2. Max over Range: The peak value is the maximum fluorescence intensity within the specified Em and/or Ex range.
2. **Fluorescence Indices:**<br>
	1. Fluorescence Index (FluI): Ratio of fluorescence intensities at `Em=470` nm and `Em=520` nm for `Ex=370` nm.
	2. Freshness Index (FrI): Ratio of fluorescence intensities at `Em=380` nm and the maximum intensity between `Em=420` nm and `Em=435` nm for `Ex=310` nm.
	3. Biological Index (BIX): Ratio of fluorescence intensities at `Em=380` nm and `Em=430` nm for `Ex=310` nm.
	4. Humification Index (HIX): Ratio of the sum of fluorescence intensities between `Em=435` nm and `Em=480` nm to the sum of intensities between `Em=300` nm and `Em=345` nm plus `Em=435` nm and `Em=480` nm for `Ex=254` nm.


<table border="1">
    <tr>
        <th>Peak Name/ Fluorescence Indices</th>
        <th>Emission Wavelengths (nm)</th>
        <th>Excitation Wavelengths (nm)</th>
        <th>Calculation Type</th>

    </tr>
    <tr>
        <td>B</td>
        <td>305</td>
        <td>275</td>
        <td>Single Point</td>
    </tr>
    <tr>
        <td>T</td>
        <td>340</td>
        <td>275</td>
        <td>Single Point</td>
    </tr>
    <tr>
        <td>A</td>
        <td>400-460</td>
        <td>260</td>
        <td>Max over Range</td>
    </tr>
    <tr>
        <td>M</td>
        <td>370-410</td>
        <td>290-310</td>
        <td>Max over Range</td>

    </tr>
    <tr>
        <td>C</td>
        <td>420-460</td>
        <td>320-360</td>
        <td>Max over Range</td>

    </tr>
    <tr>
        <td>D</td>
        <td>509</td>
        <td>390</td>
        <td>Single Point</td>

    </tr>
    <tr>
        <td>N</td>
        <td>370</td>
        <td>280</td>
        <td>Single Point</td>

    </tr>
    <tr>
        <td>Fluorescence Index (FluI)</td>
        <td>470, 520</td>
        <td>370</td>
        <td>Ratio</td>

    </tr>
    <tr>
        <td>Freshness Index (FrI)</td>
        <td>380, 420-435</td>
        <td>310</td>
        <td>Ratio</td>

    </tr>
    <tr>
        <td>Biological Index (BIX)</td>
        <td>380, 430</td>
        <td>310</td>
        <td>Ratio</td>

    </tr>
    <tr>
        <td>Humification Index (HIX)</td>
        <td>300-345, 435-480</td>
        <td>254</td>
        <td>Ratio</td>

    </tr>
</table>

